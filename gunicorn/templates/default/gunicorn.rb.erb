##
# Gunicorn config at <%= @name %>
# Managed by Chef - Local Changes will be Nuked from Orbit (just to be sure)
##

# What address:port to bind
bind = "<%= @bind %>"

backlog = <%= @connection_backlog %>

# How many worker processes
workers = <%= @worker_processes %>

worker_class = "<%= @worker_class %>"

worker_connections = <%= @max_worker_connections %>

# What the timeout for killing busy workers is, in seconds
timeout = <%= @worker_timeout %>

keepalive = <%= @keepalive %>

proc_name = "<%= @name %>"

<%- if @preload_app %>
preload_app = True

<%- end %>
<%- if @daemon %>
daemon = True

<%- end %>
<%- if @debug %>
debug = True

<%- end %>
<%- if @run_user %>
user = "<%= @run_user %>"

<%- end %>
<%- if @run_group %>
group = "<%= @run_group %>"

<%- end %>
umask = "<%= @umask %>"

<%- if @pid %>
pidfile = "<%= @pid %>"

<%- end %>
<%- if @logfile %>
logfile = "<%= @logfile %>"

<%- end %>
<%- if @loglevel %>
loglevel = "<%= @loglevel %>"

<%- end %>
<%- if @pre_fork %>
# What to do before we fork a worker
def def_pre_fork(server, worker):
    <%= @pre_fork %>

<%- end %>
<%- if @post_fork %>
# What to do after we fork a worker
def def_post_fork(server, worker):
    <%= @post_fork %>

<%- end %>
<%- if @when_ready %>
def def_start_server(server):
    <%= @when_ready %>

<%- end %>
<%- if @pre_exec %>
def def_pre_exec(server):
    <%= @pre_exec %>

<%- end %>
