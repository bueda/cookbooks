# Generated by Chef. 
# Local modifications will be overwritten.
<% case @protocol -%>
<% when "tcp" -%>
$ModLoad imtcp
$InputTCPServerRun <%= @node[:rsyslog][:port] %>
<% when "udp" -%>
$ModLoad imudp
$UDPServerRun <%= @node[:rsyslog][:port] %>
<% end -%>

$template PerHostAuth,"<%= @log_dir %>/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%/auth.log"
$template PerHostCron,"<%= @log_dir %>/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%/cron.log"
$template PerHostSyslog,"<%= @log_dir %>/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%/syslog"
$template PerHostApache,"<%= @log_dir %>/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%/apache2.log"

$template PerHostPerAppDjango,"<%= @log_dir %>/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%/django/%syslogtag%.log"
$template PerHostPerAppWebpy,"<%= @log_dir %>/%$YEAR%/%$MONTH%/%$DAY%/%HOSTNAME%/webpy/%syslogtag%.log"

local0.*                ?PerHostPerAppDjango
local1.*                ?PerHostApache
local2.*                ?PerHostPerAppWebpy
local0,local1,local2,local3,local4.* ~

auth,authpriv.*         ?PerHostAuth
*.*;auth,authpriv.none  -?PerHostSyslog
cron.*                  ?PerHostCron
